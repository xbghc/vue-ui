import { Meta } from '@storybook/blocks';

<Meta title="Development/Setup" />

# ⚙️ 开发环境搭建

## 🔧 环境要求

- **Node.js**: >= 16.0.0
- **pnpm**: >= 7.0.0 (推荐) 或 npm/yarn
- **Git**: 最新版本

## 📥 克隆项目

```bash
git clone https://github.com/xbghc/vue-ui.git
cd vue-ui
```

## 📦 安装依赖

### 使用 pnpm (推荐)

```bash
pnpm install
```

### 使用 npm

```bash
npm install
```

### 使用 yarn

```bash
yarn install
```

## 🚀 开发脚本

项目提供了以下开发脚本：

| 命令                      | 说明                    | 推荐度     |
| ------------------------- | ----------------------- | ---------- |
| `npm run storybook`       | 启动 Storybook 开发环境 | ⭐⭐⭐⭐⭐ |
| `npm run build`           | 构建生产版本            | ⭐⭐⭐⭐⭐ |
| `npm run build:watch`     | 监视模式构建            | ⭐⭐⭐⭐   |
| `npm run build-storybook` | 构建 Storybook 文档     | ⭐⭐⭐⭐   |
| `npm run lint`            | ESLint 代码检查         | ⭐⭐⭐⭐⭐ |
| `npm run type-check`      | TypeScript 类型检查     | ⭐⭐⭐⭐⭐ |
| `npm run clean`           | 清理构建文件            | ⭐⭐⭐     |

## 🛠️ VSCode 配置

项目已配置了 VSCode 任务，按 `Ctrl+Shift+P` → `Tasks: Run Task` 可以使用：

### 开发任务

- **Start Dev Server** - 启动开发服务器
- **Start Storybook** - 启动 Storybook
- **Build Library** - 构建组件库
- **Preview Build** - 预览构建结果

### 维护任务

- **Clean Build** - 清理构建文件
- **Type Check** - 类型检查
- **Build Docs** - 构建文档

### 组合任务

- **Full Build** - 完整构建流程
- **Reinstall Dependencies** - 重新安装依赖

## 📂 项目结构

```
vue-ui/
├── src/                      # 源代码
│   ├── components/          # 组件目录
│   │   └── ToolTip/        # ToolTip 组件
│   │       ├── ToolTip.vue        # 主组件
│   │       ├── tooltip-types.ts   # 类型定义
│   │       ├── use-tooltip.ts     # 核心逻辑
│   │       ├── tooltip.scss       # 样式文件
│   │       ├── ToolTip.stories.ts # Storybook 故事
│   │       └── index.ts           # 导出配置
│   ├── styles/             # 全局样式
│   ├── stories/            # Storybook 文档页面
│   └── index.ts            # 主入口文件
├── docs/                   # 开发者文档 (将迁移到 Storybook)
├── dist/                   # 构建输出
├── storybook-static/       # Storybook 构建输出
├── .storybook/            # Storybook 配置
├── .vscode/               # VSCode 配置
└── 配置文件...
```

## 🔨 构建配置

### Vite 配置

项目使用 Vite 作为构建工具，配置文件：`vite.config.ts`

### TypeScript 配置

- `tsconfig.json` - 主 TypeScript 配置
- `tsconfig.node.json` - Node.js 相关配置

### Storybook 配置

- `.storybook/main.ts` - 主配置
- `.storybook/preview.ts` - 预览配置

## 🧪 开发工作流

### 1. 启动开发环境

```bash
# Storybook 开发环境
npm run storybook
```

> **💡 开发建议**: 组件库使用 Storybook 作为开发环境，它提供了组件隔离开发、实时预览、交互式调试等功能。

### 2. 开发组件

1. 在 `src/components/` 下创建新组件目录
2. 实现组件逻辑和样式
3. 编写类型定义
4. 创建 Storybook 故事
5. 更新导出配置

### 3. 测试验证

```bash
# 代码质量检查
npm run check

# 单独检查
npm run type-check
npm run lint
npm run format:check

# 构建测试
npm run build

# Storybook 测试
npm run build-storybook
```

### 4. 文档维护

- 在 Storybook 中维护组件文档和使用示例
- 更新 `CHANGELOG.md`
- 确保 README 信息最新

## 🔍 调试技巧

### 1. 开发者工具

- 使用 Vue DevTools 调试组件状态
- 利用浏览器开发者工具调试样式

### 2. 日志调试

```typescript
// 在开发环境中启用日志
if (import.meta.env.DEV) {
  console.log('Debug info:', data);
}
```

### 3. Storybook 调试

- 使用 Storybook 的 Controls 面板测试属性
- 利用 Actions 面板查看事件触发
- 使用 Viewport 插件测试响应式设计

## 🚨 常见问题

### 依赖安装失败

```bash
# 清理缓存重新安装
rm -rf node_modules package-lock.json
npm install
```

### 类型错误

```bash
# 完整类型检查
npm run type-check
```

### 构建失败

```bash
# 清理后重新构建
npm run clean
npm run build
```

### Storybook 启动失败

```bash
# 删除 Storybook 缓存
rm -rf node_modules/.cache/storybook
npm run storybook
```

### 格式检查失败

```bash
# 自动修复格式问题
npm run format

# 自动修复 ESLint 问题
npm run lint:fix

# 一键修复所有问题
npm run fix
```

## 🎯 开发最佳实践

### 1. 组件开发

- 使用 Composition API 和 `<script setup>`
- 遵循 TypeScript 严格模式
- 编写完整的 Storybook 故事
- 实现 WAI-ARIA 无障碍标准

### 2. 代码质量

- 提交前运行 `npm run check`
- 遵循 ESLint 和 Prettier 规范
- 编写清晰的 TypeScript 类型定义
- 使用语义化的 CSS 类名

### 3. 文档编写

- 在 Storybook 中提供丰富的使用示例
- 编写清晰的 JSDoc 注释
- 提供 TypeScript 类型导出
- 维护组件的设计说明

## 📚 相关文档

- [代码规范](/docs/development-code-standards--docs) - ESLint、Prettier 配置和最佳实践
- [贡献指南](/docs/development-contributing--docs) - 如何参与项目开发
- [Storybook 指南](/docs/development-storybook--docs) - Storybook 开发说明
