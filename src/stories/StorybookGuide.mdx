import { Meta } from '@storybook/blocks';

<Meta title="Development/Storybook Guide" />

# ğŸ“– Storybook å¼€å‘æŒ‡å—

Storybook æ˜¯ä¸€ä¸ªç”¨äºæ„å»º UI ç»„ä»¶çš„å·¥å…·ï¼Œå®ƒæä¾›äº†éš”ç¦»å¼€å‘ç¯å¢ƒï¼Œè®©ä½ å¯ä»¥ç‹¬ç«‹åœ°å¼€å‘ã€æµ‹è¯•å’Œå±•ç¤ºç»„ä»¶ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¯åŠ¨ Storybook

```bash
npm run storybook
```

å¯åŠ¨åè®¿é—®ï¼šhttp://localhost:6006

### æ„å»ºé™æ€æ–‡æ¡£

```bash
npm run build-storybook
```

æ„å»ºç»“æœå°†è¾“å‡ºåˆ° `storybook-static/` ç›®å½•ã€‚

## ğŸ“ Storybook æ–‡ä»¶ç»“æ„

```
.storybook/
â”œâ”€â”€ main.ts          # ä¸»é…ç½®æ–‡ä»¶
â””â”€â”€ preview.ts       # é¢„è§ˆé…ç½®

src/
â”œâ”€â”€ components/ToolTip/
â”‚   â””â”€â”€ ToolTip.stories.ts   # ToolTip ç»„ä»¶çš„æ•…äº‹
â””â”€â”€ stories/
    â”œâ”€â”€ Installation.mdx     # å®‰è£…æŒ‡å—
    â”œâ”€â”€ GettingStarted.mdx   # å¿«é€Ÿå¼€å§‹
    â”œâ”€â”€ ImportMethods.mdx    # å¯¼å…¥æ–¹å¼
    â”œâ”€â”€ Development.mdx      # å¼€å‘ç¯å¢ƒæ­å»º
    â”œâ”€â”€ CodeStandards.mdx    # ä»£ç è§„èŒƒ
    â”œâ”€â”€ Contributing.mdx     # è´¡çŒ®æŒ‡å—
    â””â”€â”€ StorybookGuide.mdx   # æœ¬æ–‡æ¡£
```

## ğŸ“– Story æ–‡ä»¶è§£æ

### åŸºæœ¬ç»“æ„

```typescript
// ToolTip.stories.ts
import type { Meta, StoryObj } from '@storybook/vue3';
import { ToolTip } from './index';

const meta: Meta<typeof ToolTip> = {
  title: 'Components/ToolTip', // ä¾§è¾¹æ ä¸­çš„åˆ†ç»„å’Œåç§°
  component: ToolTip, // ç»„ä»¶
  parameters: {
    layout: 'centered', // å¸ƒå±€æ¨¡å¼
    docs: {
      description: {
        component: 'ç»„ä»¶æè¿°',
      },
    },
  },
  argTypes: {
    // æ§ä»¶é…ç½®
    content: {
      control: 'text',
      description: 'æç¤ºå†…å®¹',
      table: {
        category: 'Props',
        type: { summary: 'string' },
        defaultValue: { summary: "''" },
      },
    },
  },
  args: {
    content: 'Default tooltip content',
  },
  tags: ['autodocs'],
};

export default meta;
type Story = StoryObj<typeof meta>;

// é»˜è®¤æ•…äº‹
export const Default: Story = {
  render: args => ({
    components: { ToolTip },
    setup() {
      return { args };
    },
    template: `
      <ToolTip v-bind="args">
        <template #trigger>
          <button>Hover me</button>
        </template>
      </ToolTip>
    `,
  }),
};
```

## ğŸ® Controls æ§ä»¶ç±»å‹

### å¸¸ç”¨æ§ä»¶

```typescript
argTypes: {
  // æ–‡æœ¬è¾“å…¥
  text: { control: 'text' },

  // æ•°å­—è¾“å…¥
  number: {
    control: {
      type: 'number',
      min: 0,
      max: 100,
      step: 1
    }
  },

  // å¸ƒå°”å€¼
  boolean: { control: 'boolean' },

  // é€‰æ‹©å™¨
  select: {
    control: 'select',
    options: ['option1', 'option2']
  },

  // å•é€‰
  radio: {
    control: 'radio',
    options: ['A', 'B', 'C']
  },

  // é¢œè‰²é€‰æ‹©å™¨
  color: { control: 'color' },

  // æ—¥æœŸé€‰æ‹©å™¨
  date: { control: 'date' },

  // èŒƒå›´æ»‘å—
  range: {
    control: {
      type: 'range',
      min: 0,
      max: 100,
      step: 1
    }
  }
}
```

## ğŸ“š Story ç±»å‹

### 1. åŸºç¡€ Story

```typescript
export const Basic: Story = {
  args: {
    content: 'åŸºç¡€æç¤º',
  },
};
```

### 2. å¸¦æ¨¡æ¿çš„ Story

```typescript
export const WithTemplate: Story = {
  render: args => ({
    components: { ToolTip },
    setup() {
      return { args };
    },
    template: `
      <ToolTip v-bind="args">
        <template #trigger>
          <button style="padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px;">
            æ‚¬åœæˆ‘
          </button>
        </template>
      </ToolTip>
    `,
  }),
};
```

### 3. å¤šä¸ªå®ä¾‹çš„ Story

```typescript
export const AllPlacements: Story = {
  render: () => ({
    components: { ToolTip },
    setup() {
      const placements = [
        'top',
        'top-start',
        'top-end',
        'bottom',
        'bottom-start',
        'bottom-end',
        'left',
        'left-start',
        'left-end',
        'right',
        'right-start',
        'right-end',
      ];
      return { placements };
    },
    template: `
      <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; padding: 60px;">
        <ToolTip
          v-for="placement in placements"
          :key="placement"
          :content="placement"
          :placement="placement"
          :show-arrow="true"
        >
          <template #trigger>
            <button style="padding: 8px 12px; background: #6c757d; color: white; border: none; border-radius: 4px;">
              {{ placement }}
            </button>
          </template>
        </ToolTip>
      </div>
    `,
  }),
};
```

## ğŸ¨ è£…é¥°å™¨ (Decorators)

### å…¨å±€è£…é¥°å™¨

```typescript
// .storybook/preview.ts
export const decorators = [
  story => ({
    components: { story },
    template: `
      <div style="padding: 3rem;">
        <story />
      </div>
    `,
  }),
];
```

### Story çº§è£…é¥°å™¨

```typescript
export const Decorated: Story = {
  decorators: [
    () => ({
      template: `
        <div style="background: #f0f0f0; padding: 2rem; border-radius: 8px;">
          <story />
        </div>
      `,
    }),
  ],
};
```

## ğŸ“– æ–‡æ¡£åŠŸèƒ½

### è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ

Storybook ä¼šè‡ªåŠ¨ç”Ÿæˆï¼š

- ç»„ä»¶ API æ–‡æ¡£
- Props ç±»å‹å’Œé»˜è®¤å€¼
- äº‹ä»¶åˆ—è¡¨
- æ’æ§½ä¿¡æ¯
- ä½¿ç”¨ç¤ºä¾‹

### å¢å¼º ArgTypes é…ç½®

```typescript
argTypes: {
  content: {
    control: 'text',
    description: 'Tooltip å†…å®¹æ–‡æœ¬ï¼Œä¸é»˜è®¤æ’æ§½äºŒé€‰ä¸€',
    table: {
      category: 'Props',
      type: {
        summary: 'string',
        detail: 'string | undefined'
      },
      defaultValue: { summary: "''" },
    },
  },
  placement: {
    control: 'select',
    options: Object.values(ToolTipPlacement),
    description: 'Tooltip æ˜¾ç¤ºä½ç½®ï¼Œæ”¯æŒ 12 ç§ä½ç½®',
    table: {
      category: 'Props',
      type: {
        summary: 'ToolTipPlacement',
        detail: "'top' | 'top-start' | 'top-end' | ...",
      },
      defaultValue: { summary: "'top'" },
    },
  },
}
```

### MDX æ–‡æ¡£é¡µé¢

```mdx
import { Meta } from '@storybook/blocks';

<Meta title="Guide/Installation" />

# å®‰è£…æŒ‡å—

è¿™æ˜¯ä¸€ä¸ª MDX æ–‡æ¡£é¡µé¢ï¼Œæ”¯æŒï¼š

- Markdown è¯­æ³•
- React ç»„ä»¶
- ä»£ç é«˜äº®
- äº¤äº’å¼å…ƒç´ 
```

## ğŸ”§ å¸¸ç”¨æ’ä»¶

### å·²å®‰è£…çš„æ’ä»¶

- `@storybook/addon-essentials` - åŸºç¡€æ’ä»¶åŒ…
- `@storybook/addon-interactions` - äº¤äº’æµ‹è¯•
- `@storybook/addon-links` - é“¾æ¥åŠŸèƒ½

### æ’ä»¶åŠŸèƒ½

- **Controls** - åŠ¨æ€ä¿®æ”¹ props
- **Actions** - äº‹ä»¶æ—¥å¿—
- **Docs** - è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ
- **Viewport** - å“åº”å¼æµ‹è¯•
- **Backgrounds** - èƒŒæ™¯åˆ‡æ¢
- **Measure** - å°ºå¯¸æµ‹é‡
- **Outline** - å…ƒç´ è½®å»“

## ğŸ¯ æœ€ä½³å®è·µ

### 1. Story å‘½å

```typescript
// âœ… å¥½çš„å‘½å
export const Default = {};
export const WithLongContent = {};
export const DifferentPlacements = {};
export const DisabledState = {};

// âŒ é¿å…çš„å‘½å
export const Story1 = {};
export const test = {};
export const temp = {};
```

### 2. Args ç»„ç»‡

```typescript
// âœ… åˆç†çš„é»˜è®¤å€¼
export const Default: Story = {
  args: {
    content: 'Hello World',
    placement: 'top',
    showArrow: true,
    offset: 8,
  },
};

// âœ… ä¸“æ³¨å•ä¸€å˜åŒ–
export const NoArrow: Story = {
  args: {
    content: 'Tooltip without arrow',
    showArrow: false,
  },
};
```

### 3. æ–‡æ¡£æè¿°

```typescript
argTypes: {
  placement: {
    description: 'Tooltip æ˜¾ç¤ºä½ç½®ï¼Œæ”¯æŒ 12 ç§ä½ç½®',
    control: 'select',
    options: ['top', 'bottom', 'left', 'right', /*...*/],
    table: {
      type: { summary: 'ToolTipPlacement' },
      defaultValue: { summary: "'top'" },
      category: 'Props',
    }
  }
}
```

### 4. ç»„ç»‡ Stories

```typescript
// æŒ‰åŠŸèƒ½åˆ†ç»„
export const Basic = {};
export const WithCustomContent = {};

export const TopPlacement = {};
export const BottomPlacement = {};
export const LeftPlacement = {};
export const RightPlacement = {};

export const Disabled = {};
export const NoArrow = {};
export const CustomOffset = {};
```

## ğŸš€ è¿›é˜¶ç”¨æ³•

### 1. äº¤äº’æµ‹è¯•

```typescript
import { userEvent, within } from '@storybook/testing-library';
import { expect } from '@storybook/jest';

export const Interactive: Story = {
  play: async ({ canvasElement }) => {
    const canvas = within(canvasElement);
    const button = canvas.getByRole('button');

    // æ¨¡æ‹Ÿæ‚¬åœ
    await userEvent.hover(button);

    // æ£€æŸ¥ tooltip æ˜¯å¦æ˜¾ç¤º
    const tooltip = canvas.getByRole('tooltip');
    await expect(tooltip).toBeInTheDocument();
  },
};
```

### 2. ä¸»é¢˜åˆ‡æ¢

```typescript
// .storybook/preview.ts
export const parameters = {
  backgrounds: {
    values: [
      { name: 'light', value: '#ffffff' },
      { name: 'dark', value: '#333333' },
      { name: 'gray', value: '#f5f5f5' },
    ],
    default: 'light',
  },
};
```

### 3. è‡ªå®šä¹‰å‚æ•°

```typescript
export const WithCustomParams: Story = {
  parameters: {
    layout: 'fullscreen',
    backgrounds: { disable: true },
    docs: {
      description: {
        story: 'è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ•…äº‹ï¼Œå±•ç¤ºäº†è‡ªå®šä¹‰å‚æ•°çš„ä½¿ç”¨ã€‚',
      },
    },
  },
};
```

## ğŸ“± å“åº”å¼æµ‹è¯•

### é¢„è®¾è§†å£

```typescript
export const Mobile: Story = {
  parameters: {
    viewport: {
      viewports: {
        mobile: {
          name: 'Mobile',
          styles: { width: '375px', height: '667px' },
        },
        tablet: {
          name: 'Tablet',
          styles: { width: '768px', height: '1024px' },
        },
      },
      defaultViewport: 'mobile',
    },
  },
};
```

## ğŸ¨ ç»„ä»¶å¼€å‘å·¥ä½œæµ

### 1. åˆ›å»ºåŸºç¡€ Story

```typescript
// å…ˆåˆ›å»ºæœ€ç®€å•çš„ Story
export const Default: Story = {};
```

### 2. æ·»åŠ  Controls

```typescript
// æ·»åŠ  argTypes é…ç½®
argTypes: {
  content: { control: 'text' },
  placement: { control: 'select', options: [...] },
}
```

### 3. åˆ›å»ºå˜ä½“ Stories

```typescript
// ä¸ºä¸åŒç”¨ä¾‹åˆ›å»º Stories
export const LongContent: Story = {
  args: { content: 'è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿å¾ˆé•¿çš„æç¤ºå†…å®¹...' },
};

export const CustomPlacement: Story = {
  args: { placement: 'bottom-start' },
};
```

### 4. ä¼˜åŒ–æ–‡æ¡£

```typescript
// æ·»åŠ è¯¦ç»†çš„æè¿°å’Œåˆ†ç±»
table: {
  category: 'Props',
  type: { summary: 'string' },
  defaultValue: { summary: "''" },
}
```

## ğŸ”— æœ‰ç”¨çš„é“¾æ¥

- [Storybook å®˜æ–¹æ–‡æ¡£](https://storybook.js.org/docs)
- [Vue3 + Storybook æŒ‡å—](https://storybook.js.org/docs/vue/get-started/introduction)
- [Storybook æ’ä»¶å¸‚åœº](https://storybook.js.org/addons)
- [MDX æ–‡æ¡£æ ¼å¼](https://storybook.js.org/docs/vue/writing-docs/mdx)

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¼€å‘ç¯å¢ƒæ­å»º](/docs/development-setup--docs) - æœ¬åœ°å¼€å‘é…ç½®
- [ä»£ç è§„èŒƒ](/docs/development-code-standards--docs) - ESLintã€Prettier é…ç½®
- [è´¡çŒ®æŒ‡å—](/docs/development-contributing--docs) - å¦‚ä½•å‚ä¸é¡¹ç›®å¼€å‘
